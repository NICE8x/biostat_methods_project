---
title: "Project Report"
author: "Caroline Andy, Vasili Fokaidis, Stella Li, Tessa Senders, Lily Wang"
date: "12/11/2020"
output: html_document
---

```{r message=FALSE, warning=FALSE, echo = FALSE}
library(tidyverse)
library(arsenal)
library(MASS)
library(patchwork)

hate_crimes_df <- read.csv("./data/HateCrimes.csv") %>%
  janitor::clean_names() %>%
  rename(perc_pop_hs = perc_population_with_high_school_degree) %>% 
  mutate(hate_crimes_per_100k_splc = as.numeric(hate_crimes_per_100k_splc)) %>%
  drop_na(hate_crimes_per_100k_splc) %>% 
  mutate(unemployment = as_factor(unemployment),
         urbanization = as_factor(urbanization))
```

## Abstract


## Introduction

Since 2014, the national rate of hate crimes has been steadily increasing in the United States [CITE]. In the days following the 2016 US Presidential election, an average of 90 hate crimes per day were reported to the Southern Poverty Law Center [CITE]. 

Existing research suggests that community-level demographic variables such as racial breakdown, population density, level of educational attainment, and economic considerations (median income, poverty level, job availability) may be significant predictors of regional and state-level rates of hate crimes. [CITE] A 2017 FiveThirtyEight article titled, "Higher Rates Of Hate Crimes Are Tied To Income Inequality," used 2016 FBI and Southern Poverty Law Center data to assess the association between hate crime rate and select community-level variables [CITE]. 

For this project, we used this dataset to critically analyze this research team's findings to identify state-level variables associated with rates of hate crimes, and to generate a high performing predictive model for population-adjusted hate incidents in the United States.   


## Methods

The data used for this project included state-level hate crime rates (hate crimes per 100,000 population), as reported by the Southern Poverty Law Center during the first weeks of November, 2016. Collected state-level demographic variables include: 

- Unemployment rate (high vs low) (as of 2016)
- Urbanization (high vs low) (as of 2015)
- Median household income (as of 2016)
- Percent of residents with a high school degree (as of 2009)
- Percent of residents who are non-citizens (as of 2015)
- Income Gini coefficient (a measure of the extent to which the distribution of income among individuals within an economy deviates from a perfectly equal distribution; as of 2015)
- Percent of residents who are non-White (as of 2015)

First, we looked for missing data points. Four states--Hawaii, North Dakota, South Dakota, and Wyoming--did not report hate crime rate data, and thus were excluded from subsequent analyses. One additional state, Maine, did not report its percent of residents who were non-citizens. Washington DC was included as a state for the purposes of these analyses. 

Using this smaller dataset, our goal was to verify the significant association between hate crime rate and income inequality, and to generate our own multivariable linear regression model to assess which of these variables, if any, are associated with population-adjusted hate incidents in the United States. To do so, we first generated descriptive statistics and plotted the distribution of the outcome (population-adjusted hate incidents per 100,000 population) to determine whether any data transformations would be necessary, and to assess whether any outliers exist within the data. 

To further elucidate the existence of outliers/influential points, we visualized the hate crime rate by state, and generated residuals vs fitted, normal Q-Q, scale-location, and residuals vs leverage plots. Any states that were deemed to be an outlier were kept in subsequent analyses, but the same analyses were also run a second time on a dataset excluding the outliers for comparison.

To test for any multi-collinearity between the continuous variables, we calculated a correlation matrix. We decided that any correlation coefficient of 0.6 and above may suggest multi-collinearity, thus, one of those correlated variables should then be dropped from subsequent analyses.

In the interest of maximizing model parsimony and predictive performance, we then performed several automated procedures for variable selection. Specifically, we used backward and forward selection. We then employed criterion based approaches in variable selection, 

- We wanted to enhance model parsimony and improve performance so we first started performing automated procedures for variable selection
- We also used criterion based approaches in variable selection, including running tests to generate the 2 best models for various criteria: Cp, adjusted R squared and SSE/RSS. 
- We performed a lit review to see what variables are practically important to include for interpretability and application purposes

## Results

#### Descriptive Statistics and Data Distribution

We first generated descriptive statistics for all collected variables. 

```{r, message = FALSE, warning = FALSE, echo = FALSE}
h_c_df =
  hate_crimes_df %>%
  rename(
    Unemployment = "unemployment",
    Urbanization = "urbanization",
    "Median Household Income" = "median_household_income",
    "% Adults >25yrs With HS Degree" = "perc_pop_hs",
    "% of Population Not U.S. Citizens" = "perc_non_citizen",
    "% of Population Not White" = "perc_non_white",
    "Gini Index" = "gini_index",
    "Hate Crime Rate Per 100k" = "hate_crimes_per_100k_splc"
  ) %>%
  dplyr::select(-state)

my_controls = tableby.control(
               total = T,
               test=F,  
               numeric.stats = c("meansd", "medianq1q3", "range", "Nmiss2"),
               cat.stats = c("countpct", "Nmiss2"),
               stats.labels = list(
               meansd = "Mean (SD)",
               medianq1q3 = "Median (Q1, Q3)",
               range = "Min - Max",
               Nmiss2 = "Missing",
               countpct = "N (%)"))

tab1 = tableby( ~ ., data = h_c_df, control = my_controls)

summary(tab1) %>% 
  knitr::kable(caption = "Table 1: Descriptive Statistics of Tidied Dataset")
```

Multivariable linear regression modeling operates under several assumptions, which include residual homoscedasticity (constant variance) and normality. Initial exploration of the distribution of the hate crimes rate data showed a strong departure from standard normal distribution. Thus, we performed a Box Cox test to isolate the 'best' power transformation on the hate crimes rate variable to achieve normal residuals. 

```{r, message = FALSE, warning = FALSE, echo = FALSE}
hate_crimes_df <-
  hate_crimes_df %>%
  drop_na(hate_crimes_per_100k_splc)

mult_fit_1 = lm(hate_crimes_per_100k_splc ~ unemployment + urbanization + median_household_income + perc_pop_hs + perc_non_citizen + gini_index + perc_non_white, data = hate_crimes_df)
summary(mult_fit_1)

boxcox(mult_fit_1)
```

These results suggest that a logarithmic transformation of the hate crimes rate data would most closely approximate normal distribution. Thus, we operate moving forward in model development using the log hate crimes rate as the outcome of interest. 

```{r, message = FALSE, warning = FALSE, echo = FALSE}
hate_crimes_df = hate_crimes_df %>%
  mutate(hate_crimes_log = log(hate_crimes_per_100k_splc)) 
```

To determine whether any outliers exist within the data, we first visualized the log hate crimes rate of each state.

```{r, message = FALSE, warning = FALSE, echo = FALSE}
hate_crimes_df %>%
  drop_na(hate_crimes_log) %>%
  mutate(state = fct_reorder(state, hate_crimes_log)) %>%
ggplot(aes(x = state, y = hate_crimes_log)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 270, vjust = 0.5, hjust = 1)) +
  labs(
    x = "State",
    y = "Log Hate Crimes per 100,000 Population",
    title = "Log Hate Crimes Rate by State"
  )
```

Results show that Washington, DC may be an outlier and/or influential point in the data. To further investigate this, we generated the residuals vs fitted, normal Q-Q, scale-location, and residuals vs leverage plots. 

```{r, message = FALSE, warning = FALSE, echo = FALSE}
plot(mult_fit_1)
```

As Washington DC is clearly outside of the Cook's distance line, we conclude that it is an outlier.

#### Tests for Association and Modeling

We began our regression analyses by running linear regression models containing all possible predictors for both the untransformed hate crime rate and the log hate crime rate. Our results support the conclusions drawn in the FiveThirtyEight article: that the Gini index (income inequality) is the most significant predictor, and that percent population with a high school degree is the only other significant predictor. 

The results of backward and forward selection suggest that the Gini index and percent population with a high school degree variables are the only significant predictors included in the final model. 


## Discussion/Conclusion


## Figures and Tables

```{r}

```


## References