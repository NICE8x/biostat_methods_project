---
title: "Project Report"
author: "Caroline Andy, Vasili Fokaidis, Stella Li, Tessa Senders, Lily Wang"
date: "12/11/2020"
output: html_document
---

```{r message=FALSE, warning=FALSE, echo = FALSE}
library(tidyverse)
library(arsenal)
library(MASS)
library(patchwork)

hate_crimes_df <- read.csv("./data/HateCrimes.csv") %>%
  janitor::clean_names() %>%
  rename(perc_pop_hs = perc_population_with_high_school_degree) %>%
  mutate(hate_crimes_per_100k_splc = as.numeric(hate_crimes_per_100k_splc)) %>%
  drop_na(hate_crimes_per_100k_splc) %>% 
  mutate(unemployment = as_factor(unemployment),
         urbanization = as_factor(urbanization))
```

## Abstract
**Background:** 
Hate crimes are currently the highest priority of the FBIâ€™s civil rights program. Data suggests that various socio-economic factors, such as income inequality, are associated with hate crimes.

**Objectives:**
The authors aimed to analyze the association between community-level variables with state-level hate crime rates.

**Methods:**
The data used for this project included state-level hate crime rates per 100,000 individuals in the population, as reported by the Southern Poverty Law Center during the first weeks of November, 2016. Data also included socio-economic factors that were suspected to be associated with hate crime. The association between these socio-economic factors and hate crime outcome were examined by using multiple linear regression analysis.

**Results:**
After thorough analysis of the data and variables, DC appeared to be an outlier, and thus was dropped from the dataset. Due to multicollinearity and lack of significance in stratified analysis, socio-economic factors, median household income and urbanization, were dropped to produce the most parsimonious, and predictive model. Interestingly, the final model indicated that the percent of the population with a high school degree (as of 2009) had a significant linear association with hate crimes per 100,000 individuals in the population.

**Conclusions:**
Based on the Southern Poverty Law Center data in the beginning of November 2016, higher percent population with a high school degree (as of 2009) was associated with increased state-level hate crime rate.

## Introduction

Since 2014, the national rate of hate crimes has been steadily increasing in the United States [CITE]. In the days following the 2016 US Presidential election, an average of 90 hate crimes per day were reported to the Southern Poverty Law Center [CITE]. 

Existing research suggests that community-level socioeconomic factors such as racial breakdown, population density, level of educational attainment, and economic considerations (median income, poverty level, job availability) may be significant predictors of regional and state-level rates of hate crimes. [CITE] A 2017 FiveThirtyEight article titled, "Higher Rates Of Hate Crimes Are Tied To Income Inequality," used 2016 FBI and Southern Poverty Law Center data to assess the association between hate crime rate and select community-level variables [CITE]. 

For this project, we used this dataset to critically analyze this research team's findings to identify state-level variables associated with rates of hate crimes, and to generate a high performing predictive model for population-adjusted hate incidents in the United States.   


## Methods

### Data Exploration

The data used for this project included state-level hate crime rates (hate crimes per 100,000 population), as reported by the Southern Poverty Law Center during the first weeks of November, 2016. Collected state-level demographic variables include: 

- Unemployment rate (high vs low) (as of 2016)
- Urbanization (high vs low) (as of 2015)
- Median household income (as of 2016)
- Percent of residents with a high school degree (as of 2009)
- Percent of residents who are non-citizens (as of 2015)
- Income Gini coefficient (a measure of the extent to which the distribution of income among individuals within an economy deviates from a perfectly equal distribution; as of 2015)
- Percent of residents who are non-White (as of 2015)

First, we investigated the extent of missing data in our dataset. Four states--Hawaii, North Dakota, South Dakota, and Wyoming--did not report hate crime rate data, and thus were excluded from subsequent analyses. One additional state, Maine, did not report its percent of residents who were non-citizens. Washington DC was included as a state for the purposes of these analyses. 

Using these data, our goal was to construct our own multivariable linear regression model to assess which of the collected variables, if any, are significantly associated with population-adjusted hate incidents in the United States, to altogether critically examine the article's findings. To do so, we first generated descriptive statistics and plotted the distribution of the outcome (population-adjusted hate incidents per 100,000 population) to determine whether any data transformations would be necessary, and to assess whether any outliers exist within the data. 

To further elucidate the existence of outliers/influential points, we visualized the hate crime rate by state, and generated residuals vs fitted, normal Q-Q, scale-location, and residuals vs leverage plots. Any states that were deemed to be an outlier were included in subsequent analyses, but the same analyses were also run a second time on the dataset excluding the outliers for comparison.

To report basic descriptive statistics, we generated a table which includes the mean, median, range (min-max), interquartile range, and count of missing entries for each numeric variable, and category percent breakdowns and count of missing entries for categorical variables (Table 1).   

#### Multicollinearity and Interactions

In order to investigate the existence of multi-collinearity between the continuous variables, we generated a correlation matrix. We decided that any correlation coefficient of 0.6 and above may suggest multi-collinearity; thus, in these instances, at least one of those correlated variables were dropped during subsequent model development. 

Next, we tested for significant interactions between each of the two categorical variables, unemployment and urbanization, and all other continuous variables. Any variables with significant interactions were then stratified and analyzed again.

#### Model Development and Validation

To generate a high performing predictive model, we then performed two automated procedures for model variable selection (forward and backward selection) and several criterion based approaches (CP, r-squared and SSE/RSS). Using these results, we then identified a model which maximizes parsimony, predictive performance, interpretability and practical application, which takes into account variables deemed to be significant and practically important in existing literature.   

Model goodness of fit was also assessed on a dataset excluding Washington DC, a previously noted outlier. 

For validation, [ADD VALIDATION STUFF HERE]

## Results

#### Data Exploration

To visualize the distribution of the hate crimes rate data, we first generated an overlaid density and histogram plot (Figure 1). Multivariable linear regression modeling operates under several assumptions, which include residual homoscedasticity (constant variance) and normality. Initial exploration of the distribution of the hate crimes rate data showed a strong departure from standard normal distribution with significant right skewness. Thus, we performed a Box Cox test to isolate the 'best' power transformation on the hate crimes rate variable to achieve normal residuals. 

The generated Box Cox plot results suggest that a logarithmic transformation of the hate crimes rate data would most closely approximate normal distribution (Figure 2). Thus, we operated moving forward in model development using the log hate crimes rate as the outcome of interest. 

To investigate for any outliers in the data, we then plotted the hate crimes rate by state, and generated residuals vs fitted, normal Q-Q, scale-location, and residuals vs leverage plots (Figures 3-7). As Washington DC is clearly outside of the Cook's distance line in the residuals vs leverage plot, we concluded that this point is an outlier. 

As Washington DC is clearly outside of the Cook's distance line, we conclude that it is an outlier. This data point was included in any subsequent analyses, though all analyses were also rerun on this dataset excluding Washington DC for comparison.

A table of basic descriptive statistics for the collected socioeconomic variables is included in the appendix (Table 1).

#### Multicollinearity and Interactions



#### Model Development and Validation

To first attempt to recreate the findings of the FiveThirtyEight article, we began our regression analyses by running linear regression models containing all possible predictors for both the untransformed hate crime rate and the log hate crime rate. Our results support the conclusions drawn in the FiveThirtyEight article: that the Gini Index was the most significant predictor of state hate crime rate; percent high school graduates variables was the only other statistically significant variable. 

To generate our own predictive model, we employed two automated procedures: backward and forward selection. While the model proposed during forward selection contained all provided variables (Adjusted R-squared = ), the model generated through backwards selection was much more parsimonious and had a substantially higher adjusted R squared (Adjusted R-squared = )

We then employed three criterion based approaches in R, each of which generated the two best performing models for each possible number of included predictors. To visualize these results, we generated a plot containing the Cp criterion distribution for the top performing model for each number of included predictors (Figure 8). This shows that   



#### Tests for Association and Modeling

We began our regression analyses by running linear regression models containing all possible predictors for both the untransformed hate crime rate and the log hate crime rate. Our results support the conclusions drawn in the FiveThirtyEight article: that the Gini index (income inequality) is the most significant predictor, and that percent population with a high school degree is the only other significant predictor. 

The results of backward and forward selection suggest that the Gini index and percent population with a high school degree variables are the only significant predictors included in the final model. 


## Discussion/Conclusion


## Figures and Tables

```{r}
## FIGURE 1
hate_crimes_df %>%
  ggplot(aes(x = hate_crimes_per_100k_splc)) +
  geom_histogram(aes(y=..density..)) +
  geom_density(alpha=.1, fill="#FF6666") + 
  labs(
    x = "Hate Crimes Per 100k",
    y = "Density",
    caption = "Figure 1: Untransformed distribution of hate crimes per 100k"
  )
```
```{r, message = FALSE, warning = FALSE, echo = FALSE}
## FIGURE 2
mult_fit_1 = lm(hate_crimes_per_100k_splc ~ unemployment + urbanization + median_household_income + perc_pop_hs + perc_non_citizen + gini_index + perc_non_white, data = hate_crimes_df)

boxcox(mult_fit_1)
```
```{r, message = FALSE, warning = FALSE, echo = FALSE}
## FIGURE 3
hate_crimes_df = hate_crimes_df %>%
  mutate(hate_crimes_log = log(hate_crimes_per_100k_splc)) 

hate_crimes_df %>%
  drop_na(hate_crimes_log) %>%
  mutate(state = fct_reorder(state, hate_crimes_log)) %>%
ggplot(aes(x = state, y = hate_crimes_log)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 270, vjust = 0.5, hjust = 1)) +
  labs(
    x = "State",
    y = "Log Hate Crimes per 100,000 Population",
    title = "Figure 3. Log Hate Crimes Rate by State"
  )
```

```{r, message = FALSE, warning = FALSE, echo = FALSE}
## FIGURES 4-7
plot(mult_fit_1)
```

```{r, message = FALSE, warning = FALSE, echo = FALSE}
## TABLE 1
h_c_df =
  hate_crimes_df %>%
  rename(
    Unemployment = "unemployment",
    Urbanization = "urbanization",
    "Median Household Income" = "median_household_income",
    "% Adults >25yrs With HS Degree" = "perc_pop_hs",
    "% of Population Not U.S. Citizens" = "perc_non_citizen",
    "% of Population Not White" = "perc_non_white",
    "Gini Index" = "gini_index",
    "Hate Crime Rate Per 100k" = "hate_crimes_per_100k_splc"
  ) %>%
  dplyr::select(-state)

my_controls = tableby.control(
               total = T,
               test=F,  
               numeric.stats = c("meansd", "medianq1q3", "range", "Nmiss2"),
               cat.stats = c("countpct", "Nmiss2"),
               stats.labels = list(
               meansd = "Mean (SD)",
               medianq1q3 = "Median (Q1, Q3)",
               range = "Min - Max",
               Nmiss2 = "Missing",
               countpct = "N (%)"))

tab1 = tableby( ~ ., data = h_c_df, control = my_controls)

summary(tab1) %>% 
  knitr::kable(caption = "Table 1: Descriptive Statistics of Tidied Dataset")
```


## References