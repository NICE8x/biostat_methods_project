---
title: "Exploratory Analysis"
author: "Tessa Senders"
date: "12/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load libraries, warning=FALSE, message=FALSE}
library(tidyverse)
library(stringr)
```


```{r load data}
hate_crimes_df <- read.csv("./data/HateCrimes.csv") %>%
  janitor::clean_names() %>%
  mutate(hate_crimes_per_100k_splc = as.numeric(hate_crimes_per_100k_splc)) %>%
  drop_na(hate_crimes_per_100k_splc) %>%
  mutate(unemployment = as_factor(unemployment),
         urbanization = as_factor(urbanization))
```

4 Missing states (Hawaii, North Dakota, South Dakota, Wyoming)

Percent Non Citizen Maine is missing


```{r descriptive stats}
hate_crimes_df %>%
  ggplot(aes(x = hate_crimes_per_100k_splc)) +
  geom_density()
```


```{r attempt transformation of outcome}
hate_crimes_df %>%
  mutate(hate_crimes_per_100k_splc = log(hate_crimes_per_100k_splc)) %>%
  ggplot(aes(x = hate_crimes_per_100k_splc)) +
  geom_density()
  
```


Add Box Cox Transformation Here


```{r add log transform}
hate_crimes_df <- hate_crimes_df %>%
  mutate(hate_crimes_log = log(hate_crimes_per_100k_splc))
```

```{r box plot}
hate_crimes_df %>%
  mutate(state = fct_reorder(state, hate_crimes_log)) %>%
ggplot(aes(x = state, y = hate_crimes_log)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 270, vjust = 0.5, hjust=1))
```

DESCRIPTIVE STATISTICS 
Table 1
More boxplots
etc.
Box Cox
2 people:Stella, Vasili


regress given covariate

Lets do research to pick other covariates to include in our model

Variables shown to be statistically significant in existent literature: 

- Race, religion, sexual orientation - Source: Study of Literature And Legislation on Hate Crime in America (147 page report for the US Justice Department) (https://www.ncjrs.gov/pdffiles1/nij/grants/210300.pdf)
- Urbanization/population density, economic considerations (median income, poverty level, job availability), cultural and education factors - Source: US FBI website (https://ucr.fbi.gov/hate-crime/2011/resources/variables-affecting-crime)

Can also do a backwards stepwise selection to come up with a preliminary model and then add/subtract from that too

Make the association matrix and compare covariates-look for multicollinearity
3 people: Lily, Caroline, Tessa

```{r model_stuff, message = FALSE, warning = FALSE}
hate_crimes_df = hate_crimes_df %>%
  mutate(log_hate_crimes_rate = log(hate_crimes_per_100k_splc)) %>%
  drop_na()

mult.fit <- lm(log_hate_crimes_rate ~ ., data = hate_crimes_df)
step(mult.fit, direction = 'backward')
```












